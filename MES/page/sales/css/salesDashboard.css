/* page/sales/css/salesDashboard.css - FULL VERSION FIX */

/* ==========================================================================
   1. RESET & MAIN LAYOUT (แก้ปัญหาทะลุจอ)
   ========================================================================== */
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
    overflow: hidden !important; /* ล็อคหน้าจอหลักห้ามเลื่อน */
}

.page-container {
    height: 100vh;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

#main-content {
    flex: 1; /* ยืดเต็มพื้นที่ที่เหลือจาก Header */
    height: 100%;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Wrapper ที่หุ้มการ์ดค้นหา และ การ์ดตาราง */
.content-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column; /* เรียงบนลงล่าง */
    overflow: hidden; /* ห้าม Scroll ที่นี่ */
    padding: 1rem !important;
    height: 100%; 
    min-height: 0; /* สำคัญ! ป้องกัน Flex item ดันทะลุ */
}

/* ==========================================================================
   2. CARDS LAYOUT (จัดระเบียบการ์ด)
   ========================================================================== */

/* การ์ดค้นหา (ใบระบน) */
.card.mb-3 {
    flex: 0 0 auto; /* ให้สูงเท่าเนื้อหา ไม่ยืด */
    margin-bottom: 1rem !important;
}

/* การ์ดตาราง (ใบล่าง - ตัวปัญหา h-100) */
.card.table-card {
    flex: 1; /* ยืดกินพื้นที่ที่เหลือทั้งหมด */
    min-height: 0; /* ยอมหดตัวได้ */
    height: auto !important; /* ยกเลิก h-100 เดิมของ Bootstrap เพื่อไม่ให้ทะลุ */
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border: 1px solid #dee2e6;
}

/* ==========================================================================
   3. TABLE CONTAINER (พระเอก - พื้นที่ Scroll)
   ========================================================================== */
.table-responsive-custom {
    flex: 1;
    width: 100%;
    height: 100%;
    overflow-x: auto !important;
    overflow-y: auto !important;
    position: relative; /* ให้ Sticky Header อิงกับกล่องนี้ */
    background-color: #fff;
    padding-bottom: 5px; /* กัน Scrollbar ทับบรรทัดล่างสุด */
}

/* สั่งให้ตารางขยายกว้างตามเนื้อหาจริง (แก้ปัญหา Scrollbar แนวนอนไม่ขึ้น) */
.table-responsive-custom table {
    width: max-content !important; 
    min-width: 100%;
    border-collapse: separate; /* จำเป็นสำหรับ Sticky */
    border-spacing: 0;
}

/* ==========================================================================
   4. STICKY HEADERS & COLUMNS (FIXED WIDTH & POSITIONS)
   ========================================================================== */

/* --- 1. Reset Bootstrap Default --- */
thead.sticky-top {
    position: static !important;
    z-index: auto !important;
}

/* --- 2. General Sticky Logic (Header & Columns) --- */
/* กฏ: ทุกเซลล์ที่ Sticky ต้องทึบและมีขอบ */
thead.sticky-top th, 
tbody td.sticky-col-left-1,
tbody td.sticky-col-left-2,
tbody td.sticky-col-left-3,
tbody td.sticky-col-right-1,
tbody td.sticky-col-right-2 {
    background-color: #fff; /* สีพื้นหลังต้องทึบ ห้ามใส */
    background-clip: padding-box;
    position: sticky !important;
    z-index: 100; /* ระดับความสูงพื้นฐานของตัวล็อค */
}

/* Header ต้องอยู่สูงกว่า Column เสมอ */
thead.sticky-top th {
    top: 0 !important;
    z-index: 500 !important;
    background-color: #f8f9fa !important;
    border-bottom: 2px solid #dee2e6;
    box-shadow: 0 2px 2px -1px rgba(0, 0, 0, 0.1);
}

/* --- 3. FIX LEFT COLUMNS (คำนวณความกว้างเป๊ะๆ) --- */

/* [คอลัมน์ 1] Load Status */
.sticky-col-left-1 {
    left: 0 !important;
    width: 130px !important;      
    min-width: 130px !important;
    max-width: 130px !important;
    border-right: 1px solid #dee2e6;
}

/* [คอลัมน์ 2] Prod Status */
.sticky-col-left-2 {
    left: 130px !important;
    width: 130px !important;      
    min-width: 130px !important;
    max-width: 130px !important;
    border-right: 1px solid #dee2e6;
}

/* [คอลัมน์ 3] PO Number */
.sticky-col-left-3 {
    left: 260px !important;       
    width: 150px !important;
    min-width: 150px !important;
    max-width: 150px !important;
    border-right: 2px solid #dee2e6; 
    box-shadow: 4px 0 5px -2px rgba(0,0,0,0.1); 
}

/* --- 4. FIX RIGHT COLUMNS --- */

/* [ขวา 1] Cutoff Time (ริมสุด) */
.sticky-col-right-1 {
    right: 0 !important;
    width: 100px !important;
    min-width: 100px !important;
    border-left: 1px solid #dee2e6;
}

/* [ขวา 2] Cutoff Date (ถัดเข้ามา) */
.sticky-col-right-2 {
    right: 108px !important;      /* เท่ากับความกว้าง Right 1 */
    width: 110px !important;
    min-width: 110px !important;
    border-left: 2px solid #dee2e6;
    
    /* เงาด้านซ้าย */
    box-shadow: -4px 0 5px -2px rgba(0,0,0,0.1); 
}

/* --- 5. THE CORNER FIX (จุดตัดหัวมุมบนสุด) --- */
/* ต้องอยู่สูงที่สุด (Z-Index 1000) และตำแหน่งต้องตรงกับ Column ด้านล่าง */

/* มุมซ้ายบน 1 */
thead.sticky-top th.sticky-col-left-1 { 
    z-index: 1000 !important; 
    left: 0 !important; 
}
/* มุมซ้ายบน 2 */
thead.sticky-top th.sticky-col-left-2 { 
    z-index: 1000 !important; 
    left: 130px !important; 
}
/* มุมซ้ายบน 3 */
thead.sticky-top th.sticky-col-left-3 { 
    z-index: 1000 !important; 
    left: 260px !important; 
    box-shadow: 4px 2px 5px -2px rgba(0,0,0,0.1); 
}

/* มุมขวาบน 1 */
thead.sticky-top th.sticky-col-right-1 { 
    z-index: 1000 !important; 
    right: 0 !important; 
}
/* มุมขวาบน 2 */
thead.sticky-top th.sticky-col-right-2 { 
    z-index: 1000 !important; 
    right: 108px !important; 
    box-shadow: -4px 2px 5px -2px rgba(0,0,0,0.1); 
}

/* --- 6. Hover & Colors --- */
/* แก้ให้สีพื้นหลังเปลี่ยนตามแถว */
tr:hover td.sticky-col-left-1, 
tr:hover td.sticky-col-left-2, 
tr:hover td.sticky-col-left-3,
tr:hover td.sticky-col-right-1, 
tr:hover td.sticky-col-right-2 {
    background-color: var(--bs-tertiary-bg) !important;
}

/* แก้ให้สีพื้นหลังเปลี่ยนตามสถานะ (ถ้ามี class) */
tr.row-confirmed td.sticky-col-left-1, 
tr.row-confirmed td.sticky-col-left-2, 
tr.row-confirmed td.sticky-col-left-3 {
    background-color: #d1e7dd !important; 
}

/* ==========================================================================
   5. CUSTOM SCROLLBAR (ปรับให้สวยและกดง่าย)
   ========================================================================== */
.table-responsive-custom::-webkit-scrollbar {
    width: 16px;
    height: 16px;
}

.table-responsive-custom::-webkit-scrollbar-track {
    background: #f1f1f1;
    border: 1px solid #dee2e6;
    border-radius: 0 0 4px 4px;
}

.table-responsive-custom::-webkit-scrollbar-thumb {
    background-color: #adb5bd;
    border: 3px solid #f1f1f1; /* ขอบขาวเพื่อให้ดูโค้งมน */
    border-radius: 10px;
}

.table-responsive-custom::-webkit-scrollbar-thumb:hover {
    background-color: #6c757d;
    cursor: pointer;
}

.table-responsive-custom::-webkit-scrollbar-corner {
    background: #f1f1f1;
}

/* ==========================================================================
   6. UTILITIES & INPUTS
   ========================================================================== */
.editable-input {
    width: 100%;
    border: 1px solid transparent;
    background: transparent;
    padding: 2px 4px;
    border-radius: 3px;
    font-size: 0.9rem;
}

.editable-input:focus, .editable-input:hover {
    border-color: #ced4da;
    background-color: #fff;
    outline: none;
}

.status-badge {
    border: none;
    border-radius: 50px;
    padding: 4px 12px;
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
}
.status-badge.bg-pending {
    background-color: #fff3cd;
    color: #856404;
}

/* KPI Column Helper */
@media (min-width: 992px) {
    .col-lg-20-percent {
        flex: 0 0 auto;
        width: 20%;
    }
}